{% extends "podmin/site/base.html" %}
{% load static from staticfiles %}
{% block externals %}

{% endblock %}

{% block title %}{{ podcast.title }}{% endblock %}
{% block podcast_subtitle %}{{ podcast.subtitle }}{% endblock %}

{% block content %}

<!-- Block with the podcast image and description -->
<div class="row">
  <div class="three columns">
    {% if podcast.image %}
    <img src="{{podcast.medium_image}}" alt="podcast image">
    {% endif %}
  </div>
  <div class="nine columns">
    <h3>{{podcast.title}}</h3>
    <h4>{{podcast.subtitle}}</h4>
    <p>
    Itunes Categories:
    {% for category in podcast.itunes_categories.all %}
      {{ category }} |
    {% endfor %}
    </p>
    <p>
    Tags: {{ podcast.tags }}
    </p>
    <p>{{podcast.description}}</p>
  </div>
</div>

{% for e in episodes %}
<div class="row">
  <div class="two columns">

    {% if e.image %}
    <img src="{{e.image.url}}" alt="episode image">
    {% endif %}
  </div>
  <div class="six columns">
    <a href="{% url 'episode_show' slug=e.podcast.slug eid=e.id %}">
      {{ e.title }}
    </a><br>
    {{ e.description }}<br>
    <em>published {{ e.pub_date }}</em>
    {% if editor or user.is_superuser %}
      <a href="{% url 'episode_edit' slug=e.podcast.slug eid=e.id %}">Edit</a> |
      <a href="{% url 'episode_delete' slug=e.podcast.slug eid=e.id %}">Delete</a>
    {% endif %}
  </div>

  <div class="four columns">
<!--
    <div id="jquery_jplayer_{{ e.id }}" class="jp-jplayer"></div>
    <div id="jp_container_{{ e.id }}" class="jp-audio" role="application" aria-label="media player">
      <div class="jp-type-single">
          <div class="jp-gui jp-interface">
            <div class="jp-volume-controls">
                <div class="jp-volume-bar">
                  <div class="jp-volume-bar-value"></div>
                </div>
            </div>
            <div class="jp-controls-holder">
              <div class="jp-controls">
                <button class="jp-play" role="button" tabindex="0">play</button>
                <button class="jp-stop" role="button" tabindex="0">stop</button>
              </div>
              <div class="jp-progress">
                <div class="jp-seek-bar">
                  <div class="jp-play-bar"></div>
                </div>
              </div>
              <div class="jp-current-time" role="timer" aria-label="time">&nbsp;</div>
              <div class="jp-duration" role="timer" aria-label="duration">&nbsp;</div>
            </div>
          </div>
        <div class="jp-details">
          <div class="jp-title" aria-label="title">&nbsp;</div>
        </div>
        <div class="jp-no-solution">
          Player not available.
        </div>
      </div>
    </div>
  -->
  </div>
</div>

{% endfor %}

{% endblock %}

{% block footscripts %}

<link type="text/css" href="{% static 'bower_components/jplayer/skin/blue.monday/jplayer.blue.monday.css' %}" rel="stylesheet" />
<script src="{% static 'bower_components/jplayer/dist/jplayer/jquery.jplayer.min.js' %}"></script>

<script type="text/javascript">
  $(document).ready(function(){
    {% for e in episodes %}
      $("#jquery_jplayer_{{ e.id }}").jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", {
            title: "{{ e.title }}",
            mp3: "{{ podcast.storage_url }}/media/{{ e.audio_filename }}"
          });
        },
        cssSelectorAncestor: "#jp_container_{{ e.id }}",
        play: function() { // To avoid multiple jPlayers playing together.
          $(this).jPlayer("pauseOthers");
        },
        swfPath: "{% static 'bower_components/jplayer/dist/jplayer/' %}",
        supplied: "mp3",
        wmode: "window",
        globalVolume: true,
        useStateClassSkin: true,
        autoBlur: false,
        smoothPlayBar: true,
        keyEnabled: true
      });
    {% endfor %}
  });
</script>
{% endblock %}