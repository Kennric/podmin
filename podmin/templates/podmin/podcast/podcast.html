{% extends "podmin/site/base.html" %}
{% load static from staticfiles %}
{% load paginator %}

{% block externals %}

{% endblock %}

{% block title %}{{ podcast.title }}{% endblock %}
{% block podcast_subtitle %}{{ podcast.subtitle }}{% endblock %}

{% block content %}

<!-- Block with the podcast image and description -->
<div class="row">
  <div class="three columns">
    {% if podcast.image %}
    <img src="{{podcast.medium_image}}" alt="podcast image">
    {% endif %}
  </div>
  <div class="nine columns">
    <h3>{{podcast.title}}</h3>
    <h4>{{podcast.subtitle}}</h4>
    <p>
    Itunes Categories:
    {% for category in podcast.itunes_categories.all %}
      {{ category }} |
    {% endfor %}
    </p>
    <p>
    Tags: {{ podcast.tags }}
    </p>
    <p>{{podcast.description|safe}}</p>
  </div>
</div>


{% for e in episodes %}
<div class="row">
  <div class="two columns">

    {% if e.image %}
    <img src="{{e.small_image}}" alt="episode image">
    {% endif %}
  </div>
  <div class="ten columns">
    <a href="{% url 'episode_show' slug=e.podcast.slug eid=e.id %}">
      {{ e.title }}
    </a><br>
    {{ e.description }}<br>
    <em>published {{ e.pub_date }}</em>
    {% if editor or user.is_superuser %}
      <a href="{% url 'episode_edit' slug=e.podcast.slug eid=e.id %}">Edit</a> |
      <a href="{% url 'episode_delete' slug=e.podcast.slug eid=e.id %}">Delete</a>
    {% endif %}
  </div>

</div>

{% endfor %}

{% if episodes.paginator.num_pages > 1 %}
<div class="row">
  <div class="centered six columns">
    {% paginator episodes 8 %}
  </div>
</div>
{% endif %}

{% endblock %}

{% block footscripts %}

<link type="text/css" href="{% static 'bower_components/jplayer/skin/blue.monday/jplayer.blue.monday.css' %}" rel="stylesheet" />
<script src="{% static 'bower_components/jplayer/dist/jplayer/jquery.jplayer.min.js' %}"></script>

<script type="text/javascript">
  $(document).ready(function(){
    {% for e in episodes %}
      $("#jquery_jplayer_{{ e.id }}").jPlayer({
        ready: function () {
          $(this).jPlayer("setMedia", {
            title: "{{ e.title }}",
            mp3: "{{ e.audio_url }}"
          });
        },
        cssSelectorAncestor: "#jp_container_{{ e.id }}",
        play: function() { // To avoid multiple jPlayers playing together.
          $(this).jPlayer("pauseOthers");
        },
        swfPath: "{% static 'bower_components/jplayer/dist/jplayer/' %}",
        supplied: "mp3",
        wmode: "window",
        globalVolume: true,
        useStateClassSkin: true,
        autoBlur: false,
        smoothPlayBar: true,
        keyEnabled: true
      });
    {% endfor %}
  });
</script>
{% endblock %}

